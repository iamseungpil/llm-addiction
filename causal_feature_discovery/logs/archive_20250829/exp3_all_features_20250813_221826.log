/data/miniforge3/lib/python3.10/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(

================================================================================
REWARD CHOICE EXPERIMENT
================================================================================
================================================================================
Loading Models for Reward Choice Experiment
================================================================================
Loading Llama-3.1-8B-Base model...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:01<00:05,  1.97s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:02<00:02,  1.38s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:03<00:01,  1.22s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:04<00:00,  1.14it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:04<00:00,  1.08s/it]

Loading SAEs...
âœ… Loading WORKING SAE for Layer 25
   Config: /data/.cache/huggingface/hub/models--fnlp--Llama3_1-8B-Base-LXR-8x/snapshots/8dbc1d85edfced43081c03c38b05514dbab1368b/Llama3_1-8B-Base-L25R-8x/hyperparams.json
   Dataset norm: 31.625
   Norm factor: 2.023715
   Using ReLU instead of JumpReLU (threshold=0.0)
   Checkpoint: /data/.cache/huggingface/hub/models--fnlp--Llama3_1-8B-Base-LXR-8x/snapshots/8dbc1d85edfced43081c03c38b05514dbab1368b/Llama3_1-8B-Base-L25R-8x/checkpoints/final_fixed.pth
âœ… Working SAE loaded successfully!
   Expected reconstruction error: ~47%
   Feature clamping: VERIFIED WORKING
âœ… Layer 25 SAE loaded
âœ… Loading WORKING SAE for Layer 30
   Config: /data/.cache/huggingface/hub/models--fnlp--Llama3_1-8B-Base-LXR-8x/snapshots/8dbc1d85edfced43081c03c38b05514dbab1368b/Llama3_1-8B-Base-L30R-8x/hyperparams.json
   Dataset norm: 53.25
   Norm factor: 1.201878
   Using ReLU instead of JumpReLU (threshold=0.0)
   Checkpoint: /data/.cache/huggingface/hub/models--fnlp--Llama3_1-8B-Base-LXR-8x/snapshots/8dbc1d85edfced43081c03c38b05514dbab1368b/Llama3_1-8B-Base-L30R-8x/checkpoints/final_fixed.pth
âœ… Working SAE loaded successfully!
   Expected reconstruction error: ~47%
   Feature clamping: VERIFIED WORKING
âœ… Layer 30 SAE loaded

Loading features from: /data/llm_addiction/results/llama_feature_arrays_20250813_152135.npz
âœ… Layer 25: 192 target features loaded
âœ… Layer 30: 200 target features loaded

Total experiments: 300

ðŸ“Š Layer 25, Clamping 0.0x
  Trial 10: A=85.7%, B=14.3%, C=0.0%, Avg risk=0.14
  Trial 20: A=56.2%, B=18.8%, C=25.0%, Avg risk=0.69
  Trial 30: A=60.0%, B=16.0%, C=24.0%, Avg risk=0.64

ðŸ“Š Layer 25, Clamping 0.5x
  Trial 10: A=66.7%, B=16.7%, C=16.7%, Avg risk=0.50
  Trial 20: A=71.4%, B=14.3%, C=14.3%, Avg risk=0.43
  Trial 30: A=77.8%, B=11.1%, C=11.1%, Avg risk=0.33

ðŸ“Š Layer 25, Clamping 1.0x
  Trial 10: A=50.0%, B=50.0%, C=0.0%, Avg risk=0.50
  Trial 20: A=66.7%, B=33.3%, C=0.0%, Avg risk=0.33
  Trial 30: A=70.0%, B=30.0%, C=0.0%, Avg risk=0.30

ðŸ“Š Layer 25, Clamping 2.0x
  Trial 10: A=0.0%, B=50.0%, C=50.0%, Avg risk=1.50
  Trial 20: A=25.0%, B=50.0%, C=25.0%, Avg risk=1.00
  Trial 30: A=40.0%, B=40.0%, C=20.0%, Avg risk=0.80

ðŸ“Š Layer 25, Clamping 5.0x
  Trial 10: A=33.3%, B=0.0%, C=66.7%, Avg risk=1.33
  Trial 20: A=42.9%, B=14.3%, C=42.9%, Avg risk=1.00
  Trial 30: A=50.0%, B=10.0%, C=40.0%, Avg risk=0.90

ðŸ“Š Layer 30, Clamping 0.0x
  Trial 10: A=40.0%, B=20.0%, C=40.0%, Avg risk=1.00
  Trial 20: A=20.0%, B=10.0%, C=70.0%, Avg risk=1.50
  Trial 30: A=20.0%, B=20.0%, C=60.0%, Avg risk=1.40

ðŸ“Š Layer 30, Clamping 0.5x
  Trial 20: A=100.0%, B=0.0%, C=0.0%, Avg risk=0.00
  Trial 30: A=50.0%, B=0.0%, C=50.0%, Avg risk=1.00

ðŸ“Š Layer 30, Clamping 1.0x
  Trial 10: A=100.0%, B=0.0%, C=0.0%, Avg risk=0.00
  Trial 20: A=100.0%, B=0.0%, C=0.0%, Avg risk=0.00
  Trial 30: A=100.0%, B=0.0%, C=0.0%, Avg risk=0.00

ðŸ“Š Layer 30, Clamping 2.0x
  Trial 10: A=100.0%, B=0.0%, C=0.0%, Avg risk=0.00
  Trial 20: A=66.7%, B=0.0%, C=33.3%, Avg risk=0.67
  Trial 30: A=50.0%, B=0.0%, C=50.0%, Avg risk=1.00

ðŸ“Š Layer 30, Clamping 5.0x
  Trial 10: A=0.0%, B=33.3%, C=66.7%, Avg risk=1.67
  Trial 20: A=20.0%, B=20.0%, C=60.0%, Avg risk=1.40
  Trial 30: A=33.3%, B=16.7%, C=50.0%, Avg risk=1.17

âœ… Results saved to: /data/llm_addiction/results/exp3_reward_choice_20250813_223217.json

SUMMARY:

layer_25:
  0.0x: A=60.0%, B=16.0%, C=24.0%, Avg risk=0.64
  0.5x: A=77.8%, B=11.1%, C=11.1%, Avg risk=0.33
  1.0x: A=70.0%, B=30.0%, C=0.0%, Avg risk=0.30
  2.0x: A=40.0%, B=40.0%, C=20.0%, Avg risk=0.80
  5.0x: A=50.0%, B=10.0%, C=40.0%, Avg risk=0.90

layer_30:
  0.0x: A=20.0%, B=20.0%, C=60.0%, Avg risk=1.40
  0.5x: A=50.0%, B=0.0%, C=50.0%, Avg risk=1.00
  1.0x: A=100.0%, B=0.0%, C=0.0%, Avg risk=0.00
  2.0x: A=50.0%, B=0.0%, C=50.0%, Avg risk=1.00
  5.0x: A=33.3%, B=16.7%, C=50.0%, Avg risk=1.17

âœ… Reward choice experiment complete!
