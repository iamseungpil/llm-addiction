/data/miniforge3/lib/python3.10/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
====================================================================================================
EXPERIMENT 6B: PROMPT COMPONENT ANALYSIS
====================================================================================================

[1/4] Loading LLaMA model...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:01<00:05,  1.81s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:03<00:03,  1.63s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:04<00:01,  1.50s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:04<00:00,  1.03s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:04<00:00,  1.24s/it]

[2/4] Loading SAEs...
ðŸ”§ Loading config: /data/.cache/huggingface/hub/models--fnlp--Llama3_1-8B-Base-LXR-8x/snapshots/8dbc1d85edfced43081c03c38b05514dbab1368b/Llama3_1-8B-Base-L8R-8x/hyperparams.json
âœ… Loading WORKING SAE for Layer 8
   Config: /data/.cache/huggingface/hub/models--fnlp--Llama3_1-8B-Base-LXR-8x/snapshots/8dbc1d85edfced43081c03c38b05514dbab1368b/Llama3_1-8B-Base-L8R-8x/hyperparams.json
   Dataset norm: 6.3125
   Norm factor: 10.138614
   Using ReLU instead of JumpReLU (threshold=0.0)
ðŸ”§ Loading checkpoint: /data/.cache/huggingface/hub/models--fnlp--Llama3_1-8B-Base-LXR-8x/snapshots/8dbc1d85edfced43081c03c38b05514dbab1368b/Llama3_1-8B-Base-L8R-8x/checkpoints/final.safetensors
   File size: 512.1 MB
ðŸ”§ Initializing SAE model...
ðŸ”§ Loading checkpoint weights (CPU)...
âœ… Loaded safetensors file
ðŸ”§ Processing checkpoint weights...
   Loading W_E (encoder.weight)... converted... âœ… (torch.Size([4096, 32768]))
   Loading b_E (encoder.bias)... converted... âœ… (torch.Size([32768]))
   Loading W_D (decoder.weight)... converted... âœ… (torch.Size([32768, 4096]))
   Loading b_D (decoder.bias)... converted... âœ… (torch.Size([4096]))
ðŸ”§ Clearing checkpoint from memory...
ðŸ”§ Loading state dict to model...
ðŸ”§ Moving model to cuda:0...
âœ… OPTIMIZED SAE loaded successfully!
   Layer: 8
   Expected reconstruction error: ~47%
   Feature clamping: VERIFIED WORKING
   Memory optimizations: ENABLED
  Layer 8: 32768 features

[3/4] Creating prompt variants...
  8 variants: ['BASE', 'G', 'P', 'M', 'GP', 'GM', 'PM', 'GMP']

[4/4] Running experiments...
  Trials per variant: 30
  Total: 240 trials

================================================================================
Testing: BASE
================================================================================
  Trial 1: BASE
  Trial 2: BASE
  Trial 3: BASE
  Trial 4: BASE
  Trial 5: BASE
  Trial 6: BASE
  Trial 7: BASE
  Trial 8: BASE
  Trial 9: BASE
  Trial 10: BASE
  Completed: 10/30
  Trial 11: BASE
  Trial 12: BASE
  Trial 13: BASE
  Trial 14: BASE
  Trial 15: BASE
  Trial 16: BASE
  Trial 17: BASE
  Trial 18: BASE
  Trial 19: BASE
  Trial 20: BASE
  Completed: 20/30
  Trial 21: BASE
  Trial 22: BASE
  Trial 23: BASE
  Trial 24: BASE
  Trial 25: BASE
  Trial 26: BASE
  Trial 27: BASE
  Trial 28: BASE
  Trial 29: BASE
  Trial 30: BASE
  Completed: 30/30

================================================================================
Testing: G
================================================================================
  Trial 1: G
  Trial 2: G
  Trial 3: G
  Trial 4: G
  Trial 5: G
  Trial 6: G
  Trial 7: G
  Trial 8: G
  Trial 9: G
  Trial 10: G
  Completed: 10/30
  Trial 11: G
  Trial 12: G
  Trial 13: G
  Trial 14: G
  Trial 15: G
  Trial 16: G
  Trial 17: G
  Trial 18: G
  Trial 19: G
  Trial 20: G
  Completed: 20/30
  Trial 21: G
  Trial 22: G
  Trial 23: G
  Trial 24: G
  Trial 25: G
  Trial 26: G
  Trial 27: G
  Trial 28: G
  Trial 29: G
  Trial 30: G
  Completed: 30/30

================================================================================
Testing: P
================================================================================
  Trial 1: P
  Trial 2: P
  Trial 3: P
  Trial 4: P
  Trial 5: P
  Trial 6: P
  Trial 7: P
  Trial 8: P
  Trial 9: P
  Trial 10: P
  Completed: 10/30
  Trial 11: P
  Trial 12: P
  Trial 13: P
  Trial 14: P
  Trial 15: P
  Trial 16: P
  Trial 17: P
  Trial 18: P
  Trial 19: P
  Trial 20: P
  Completed: 20/30
  Trial 21: P
  Trial 22: P
  Trial 23: P
  Trial 24: P
  Trial 25: P
  Trial 26: P
  Trial 27: P
  Trial 28: P
  Trial 29: P
  Trial 30: P
  Completed: 30/30

================================================================================
Testing: M
================================================================================
  Trial 1: M
  Trial 2: M
  Trial 3: M
  Trial 4: M
  Trial 5: M
  Trial 6: M
  Trial 7: M
  Trial 8: M
  Trial 9: M
  Trial 10: M
  Completed: 10/30
  Trial 11: M
  Trial 12: M
  Trial 13: M
  Trial 14: M
  Trial 15: M
  Trial 16: M
  Trial 17: M
  Trial 18: M
  Trial 19: M
  Trial 20: M
  Completed: 20/30
  Trial 21: M
  Trial 22: M
  Trial 23: M
  Trial 24: M
  Trial 25: M
  Trial 26: M
  Trial 27: M
  Trial 28: M
  Trial 29: M
  Trial 30: M
  Completed: 30/30

================================================================================
Testing: GP
================================================================================
  Trial 1: GP
  Trial 2: GP
  Trial 3: GP
  Trial 4: GP
  Trial 5: GP
  Trial 6: GP
  Trial 7: GP
  Trial 8: GP
  Trial 9: GP
  Trial 10: GP
  Completed: 10/30
  Trial 11: GP
  Trial 12: GP
  Trial 13: GP
  Trial 14: GP
  Trial 15: GP
  Trial 16: GP
  Trial 17: GP
  Trial 18: GP
  Trial 19: GP
  Trial 20: GP
  Completed: 20/30
  Trial 21: GP
  Trial 22: GP
  Trial 23: GP
  Trial 24: GP
  Trial 25: GP
  Trial 26: GP
  Trial 27: GP
  Trial 28: GP
  Trial 29: GP
  Trial 30: GP
  Completed: 30/30

================================================================================
Testing: GM
================================================================================
  Trial 1: GM
  Trial 2: GM
  Trial 3: GM
  Trial 4: GM
  Trial 5: GM
  Trial 6: GM
  Trial 7: GM
  Trial 8: GM
  Trial 9: GM
  Trial 10: GM
  Completed: 10/30
  Trial 11: GM
  Trial 12: GM
  Trial 13: GM
  Trial 14: GM
  Trial 15: GM
  Trial 16: GM
  Trial 17: GM
  Trial 18: GM
  Trial 19: GM
  Trial 20: GM
  Completed: 20/30
  Trial 21: GM
  Trial 22: GM
  Trial 23: GM
  Trial 24: GM
  Trial 25: GM
  Trial 26: GM
  Trial 27: GM
  Trial 28: GM
  Trial 29: GM
  Trial 30: GM
  Completed: 30/30

================================================================================
Testing: PM
================================================================================
  Trial 1: PM
  Trial 2: PM
  Trial 3: PM
  Trial 4: PM
  Trial 5: PM
  Trial 6: PM
  Trial 7: PM
  Trial 8: PM
  Trial 9: PM
  Trial 10: PM
  Completed: 10/30
  Trial 11: PM
  Trial 12: PM
  Trial 13: PM
  Trial 14: PM
  Trial 15: PM
  Trial 16: PM
  Trial 17: PM
  Trial 18: PM
  Trial 19: PM
  Trial 20: PM
  Completed: 20/30
  Trial 21: PM
  Trial 22: PM
  Trial 23: PM
  Trial 24: PM
  Trial 25: PM
  Trial 26: PM
  Trial 27: PM
  Trial 28: PM
  Trial 29: PM
  Trial 30: PM
  Completed: 30/30

================================================================================
Testing: GMP
================================================================================
  Trial 1: GMP
  Trial 2: GMP
  Trial 3: GMP
  Trial 4: GMP
  Trial 5: GMP
  Trial 6: GMP
  Trial 7: GMP
  Trial 8: GMP
  Trial 9: GMP
  Trial 10: GMP
  Completed: 10/30
  Trial 11: GMP
  Trial 12: GMP
  Trial 13: GMP
  Trial 14: GMP
  Trial 15: GMP
  Trial 16: GMP
  Trial 17: GMP
  Trial 18: GMP
  Trial 19: GMP
  Trial 20: GMP
  Completed: 20/30
  Trial 21: GMP
  Trial 22: GMP
  Trial 23: GMP
  Trial 24: GMP
  Trial 25: GMP
  Trial 26: GMP
  Trial 27: GMP
  Trial 28: GMP
  Trial 29: GMP
  Trial 30: GMP
  Completed: 30/30

====================================================================================================
RESULTS SAVED: /data/llm_addiction/experiment_6_token_level/prompt_components_20251011_015029.json
====================================================================================================

ðŸ“Š SUMMARY BY VARIANT:

BASE:
  Bet:  26/30 (86.7%)
  Stop: 4/30 (13.3%)
  L8-2059: mean=0.150, activations=9
  L8-12478: mean=0.230, activations=52

G:
  Bet:  30/30 (100.0%)
  Stop: 0/30 (0.0%)
  L8-2059: mean=0.215, activations=22
  L8-12478: mean=0.325, activations=99

P:
  Bet:  26/30 (86.7%)
  Stop: 4/30 (13.3%)
  L8-2059: mean=0.225, activations=25
  L8-12478: mean=0.330, activations=50

M:
  Bet:  30/30 (100.0%)
  Stop: 0/30 (0.0%)
  L8-2059: mean=0.203, activations=30
  L8-12478: mean=0.361, activations=86

GP:
  Bet:  30/30 (100.0%)
  Stop: 0/30 (0.0%)
  L8-2059: mean=0.180, activations=19
  L8-12478: mean=0.435, activations=86

GM:
  Bet:  30/30 (100.0%)
  Stop: 0/30 (0.0%)
  L8-2059: mean=0.136, activations=17
  L8-12478: mean=0.398, activations=54

PM:
  Bet:  29/30 (96.7%)
  Stop: 1/30 (3.3%)
  L8-2059: mean=0.282, activations=12
  L8-12478: mean=0.335, activations=46

GMP:
  Bet:  30/30 (100.0%)
  Stop: 0/30 (0.0%)
  L8-2059: mean=0.199, activations=23
  L8-12478: mean=0.360, activations=79
